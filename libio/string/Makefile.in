# $Id$

CC		= @CC@
SED		= @SED@
STDOUT		= @STDOUT@
CFLAGS		= @IRCSERVICES_CFLAGS@
MKDEP		= @MKDEP@
MV		= @MV@
RM              = @RM@

IRCDLIBS        = @LIBS@ $(SSL_LIBS)

INCLUDES	= -I.. -I../../include
CPPFLAGS	= ${INCLUDES} -DIN_LIBIO @CPPFLAGS@

SRCS = \
  match.c \
  pcre_chartables.c \
  pcre_compile.c \
  pcre_exec.c \
  pcre_fullinfo.c \
  pcre_globals.c \
  pcre_study.c \
  pcre_tables.c \
  pcre_try_flipped.c \
  @SNPRINTF_C@ \
  sprintf_irc.c \
  string.c

OBJS = ${SRCS:.c=.o}

default: build
build: all
all: depend $(OBJS)

.c.o:
	${CC} ${CPPFLAGS} ${CFLAGS} -c $< -o $@

depend: .depend
.depend:
	${MKDEP} ${CPPFLAGS} ${SRCS} ${STDOUT}
	@${SED} -e '/^# Autogenerated - do not delete/,$$d' <Makefile >Makefile.depend
	@echo "# Autogenerated - do not delete" >>Makefile.depend
	@echo "include .depend" >> Makefile.depend
	@${MV} Makefile.depend Makefile

clean:
	${RM} -f $(OBJS)

distclean: clean
	${RM} -f Makefile .depend

install:
	
.PHONY: distclean build
