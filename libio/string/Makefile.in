# $Id$

CC		= @CC@
SED		= @SED@
STDOUT		= @STDOUT@
CFLAGS		= @IRCSERVICES_CFLAGS@
PICFLAGS  = @PICFLAGS@
MKDEP		= @MKDEP@
MV		= @MV@
RM              = @RM@

IRCDLIBS        = @LIBS@ $(SSL_LIBS)

INCLUDES	= -I.. -I../../include
CPPFLAGS	= ${INCLUDES} -DIN_LIBIO @CPPFLAGS@

SRCS = \
  match.cc \
  pcre_chartables.cc \
  pcre_compile.cc \
  pcre_exec.cc \
  pcre_fullinfo.cc \
  pcre_globals.cc \
  pcre_study.cc \
  pcre_tables.cc \
  pcre_try_flipped.cc \
  @SNPRINTF_C@ \
  sprintf_irc.cc \
  string.cc

OBJS = ${SRCS:.cc=.o}

default: build
build: all
all: depend $(OBJS)

.cc.o:
	${CXX} ${PICFLAGS} ${CPPFLAGS} ${CFLAGS} -c $< -o $@

depend: .depend
.depend:
	${MKDEP} ${CPPFLAGS} ${SRCS} ${STDOUT}
	@${SED} -e '/^# Autogenerated - do not delete/,$$d' <Makefile >Makefile.depend
	@echo "# Autogenerated - do not delete" >>Makefile.depend
	@echo "include .depend" >> Makefile.depend
	@${MV} Makefile.depend Makefile

clean:
	${RM} -f $(OBJS)

distclean: clean
	${RM} -f Makefile .depend

install:
	
.PHONY: distclean build
